/*!
 * chartjs-plugin-annotation.js
 * http://chartjs.org/
 * Version: 0.5.7
 *
 * Copyright 2016 Evert Timberg
 * Released under the MIT license
 * https://github.com/chartjs/Chart.Annotation.js/blob/master/LICENSE.md
 */
(function e(b,g,d){function c(m,j){if(!g[m]){if(!b[m]){var i=typeof require=="function"&&require;if(!j&&i){return i(m,!0)}if(a){return a(m,!0)}var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k}var h=g[m]={exports:{}};b[m][0].call(h.exports,function(l){var o=b[m][1][l];return c(o?o:l)},h,h.exports,e,b,g,d)}return g[m].exports}var a=typeof require=="function"&&require;for(var f=0;f<d.length;f++){c(d[f])}return c})({1:[function(b,c,a){},{}],2:[function(b,c,a){c.exports=function(g){var f=g.helpers;var j=b("./helpers.js")(g);var h=b("./events.js")(g);var i=g.Annotation.types;function k(l){j.decorate(l,"afterDataLimits",function(m,n){if(m){m(n)}j.adjustScaleRange(n)})}function d(l){return function(m,n){var o=m.annotation.options.drawTime;j.elements(m).filter(function(p){return l===(p.options.drawTime||o)}).forEach(function(p){p.transition(n).draw()})}}return{beforeInit:function(l){var n=l.options;var m=l.annotation={elements:{},options:j.initConfig(n.annotation||{}),onDestroy:[],firstRun:true,supported:false};l.ensureScalesHaveIDs();if(n.scales){m.supported=true;f.each(n.scales.xAxes,k);f.each(n.scales.yAxes,k)}},beforeUpdate:function(l){var m=l.annotation;if(!m.supported){return}if(!m.firstRun){m.options=j.initConfig(l.options.annotation||{})}else{m.firstRun=false}var n=[];m.options.annotations.forEach(function(o){var r=o.id||j.objectId();if(!m.elements[r]&&i[o.type]){var p=i[o.type];var q=new p({id:r,options:o,chartInstance:l});q.initialize();m.elements[r]=q;o.id=r;n.push(r)}else{if(m.elements[r]){n.push(r)}}});Object.keys(m.elements).forEach(function(o){if(n.indexOf(o)===-1){m.elements[o].destroy();delete m.elements[o]}})},afterScaleUpdate:function(l){j.elements(l).forEach(function(m){m.configure()})},beforeDatasetsDraw:d("beforeDatasetsDraw"),afterDatasetsDraw:d("afterDatasetsDraw"),afterDraw:d("afterDraw"),afterInit:function(l){var o=l.annotation.options.events;if(f.isArray(o)&&o.length>0){var m=l.chart.canvas;var n=h.dispatcher.bind(l);h.collapseHoverEvents(o).forEach(function(p){f.addEvent(m,p,n);l.annotation.onDestroy.push(function(){f.removeEvent(m,p,n)})})}},destroy:function(l){var m=l.annotation.onDestroy;while(m.length>0){m.pop()()}}}}},{"./events.js":4,"./helpers.js":5}],3:[function(b,c,a){c.exports=function(f){var d=f.helpers;var g=f.Element.extend({initialize:function(){this.hidden=false;this.hovering=false;this._model=d.clone(this._model)||{};this.setDataLimits()},destroy:function(){},setDataLimits:function(){},configure:function(){},inRange:function(){},getCenterPoint:function(){},getWidth:function(){},getHeight:function(){},getArea:function(){},draw:function(){}});return g}},{}],4:[function(b,c,a){c.exports=function(f){var d=f.helpers;var i=b("./helpers.js")(f);function h(k){var l=false;var j=k.filter(function(m){switch(m){case"mouseenter":case"mouseover":case"mouseout":case"mouseleave":l=true;return false;default:return true}});if(l&&j.indexOf("mousemove")===-1){j.push("mousemove")}return j}function g(n){var o=this.annotation;var j=i.elements(this);var m=d.getRelativePosition(n,this.chart);var l=i.getNearestItems(j,m);var q=h(o.options.events);var p=o.options.dblClickSpeed;var k=[];var s=i.getEventHandlerName(n.type);var r=(l||{}).options;if(n.type==="mousemove"){if(l&&!l.hovering){["mouseenter","mouseover"].forEach(function(t){var v=i.getEventHandlerName(t);var u=i.createMouseEvent(t,n);l.hovering=true;if(typeof r[v]==="function"){k.push([r[v],u,l])}})}else{if(!l){j.forEach(function(u){if(u.hovering){u.hovering=false;var t=u.options;["mouseout","mouseleave"].forEach(function(v){var x=i.getEventHandlerName(v);var w=i.createMouseEvent(v,n);if(typeof t[x]==="function"){k.push([t[x],w,u])}})}})}}}if(l&&q.indexOf("dblclick")>-1&&typeof r.onDblclick==="function"){if(n.type==="click"&&typeof r.onClick==="function"){clearTimeout(l.clickTimeout);l.clickTimeout=setTimeout(function(){delete l.clickTimeout;r.onClick.call(l,n)},p);n.stopImmediatePropagation();n.preventDefault();return}else{if(n.type==="dblclick"&&l.clickTimeout){clearTimeout(l.clickTimeout);delete l.clickTimeout}}}if(l&&typeof r[s]==="function"&&k.length===0){k.push([r[s],n,l])}if(k.length>0){n.stopImmediatePropagation();n.preventDefault();k.forEach(function(t){t[0].call(t[2],t[1])})}}return{dispatcher:g,collapseHoverEvents:h}}},{"./helpers.js":5}],5:[function(f,c,g){function l(){}function a(m){var n=m.annotation.elements;return Object.keys(n).map(function(o){return n[o]})}function j(){return Math.random().toString(36).substr(2,6)}function k(m){if(m===null||typeof m==="undefined"){return false}else{if(typeof m==="number"){return isFinite(m)}else{return !!m}}}function d(o,p,m){var n="$";if(!o[n+p]){if(o[p]){o[n+p]=o[p].bind(o);o[p]=function(){var q=[o[n+p]].concat(Array.prototype.slice.call(arguments));return m.apply(o,q)}}else{o[p]=function(){var q=[undefined].concat(Array.prototype.slice.call(arguments));return m.apply(o,q)}}}}function i(m,n){m.forEach(function(o){(n?o[n]:o)()})}function b(m){return"on"+m[0].toUpperCase()+m.substring(1)}function h(r,o){try{return new MouseEvent(r,o)}catch(q){try{var n=document.createEvent("MouseEvent");n.initMouseEvent(r,o.canBubble,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget);return n}catch(p){var s=document.createEvent("Event");s.initEvent(r,o.canBubble,o.cancelable);return s}}}c.exports=function(n){var m=n.helpers;function o(s){s=m.configMerge(n.Annotation.defaults,s);if(m.isArray(s.annotations)){s.annotations.forEach(function(t){t.label=m.configMerge(n.Annotation.labelDefaults,t.label)})}return s}function r(w,x,u,y){var t=x.filter(function(z){return !!z._model.ranges[w]}).map(function(z){return z._model.ranges[w]});var v=t.map(function(z){return Number(z.min)}).reduce(function(A,z){return isFinite(z)&&!isNaN(z)&&z<A?z:A},u);var s=t.map(function(z){return Number(z.max)}).reduce(function(A,z){return isFinite(z)&&!isNaN(z)&&z>A?z:A},y);return{min:v,max:s}}function q(t){var s=r(t.id,a(t.chart),t.min,t.max);if(typeof t.options.ticks.min==="undefined"&&typeof t.options.ticks.suggestedMin==="undefined"){t.min=s.min}if(typeof t.options.ticks.max==="undefined"&&typeof t.options.ticks.suggestedMax==="undefined"){t.max=s.max}if(t.handleTickRangeOptions){t.handleTickRangeOptions()}}function p(t,s){var u=Number.POSITIVE_INFINITY;return t.filter(function(v){return v.inRange(s.x,s.y)}).reduce(function(x,w){var v=w.getCenterPoint();var y=m.distanceBetweenPoints(s,v);if(y<u){x=[w];u=y}else{if(y===u){x.push(w)}}return x},[]).sort(function(y,w){var x=y.getArea(),v=w.getArea();return(x>v||x<v)?x-v:y._index-w._index}).slice(0,1)[0]}return{initConfig:o,elements:a,callEach:i,noop:l,objectId:j,isValid:k,decorate:d,adjustScaleRange:q,getNearestItems:p,getEventHandlerName:b,createMouseEvent:h}}},{}],6:[function(c,d,b){var a=c("chart.js");a=typeof(a)==="function"?a:window.Chart;a.Annotation=a.Annotation||{};a.Annotation.drawTimeOptions={afterDraw:"afterDraw",afterDatasetsDraw:"afterDatasetsDraw",beforeDatasetsDraw:"beforeDatasetsDraw"};a.Annotation.defaults={drawTime:"afterDatasetsDraw",dblClickSpeed:350,events:[],annotations:[]};a.Annotation.labelDefaults={backgroundColor:"rgba(0,0,0,0.8)",fontFamily:a.defaults.global.defaultFontFamily,fontSize:a.defaults.global.defaultFontSize,fontStyle:"bold",fontColor:"#fff",xPadding:6,yPadding:6,cornerRadius:6,position:"center",xAdjust:0,yAdjust:0,enabled:false,content:null};a.Annotation.Element=c("./element.js")(a);a.Annotation.types={line:c("./types/line.js")(a),box:c("./types/box.js")(a)};var f=c("./annotation.js")(a);d.exports=f;a.pluginService.register(f)},{"./annotation.js":2,"./element.js":3,"./types/box.js":7,"./types/line.js":8,"chart.js":1}],7:[function(b,c,a){c.exports=function(d){var f=b("../helpers.js")(d);var g=d.Annotation.Element.extend({setDataLimits:function(){var k=this._model;var j=this.options;var i=this.chartInstance;var o=i.scales[j.xScaleID];var n=i.scales[j.yScaleID];var m=i.chartArea;k.ranges={};if(!m){return}var l=0;var h=0;if(o){l=f.isValid(j.xMin)?j.xMin:o.getPixelForValue(m.left);h=f.isValid(j.xMax)?j.xMax:o.getPixelForValue(m.right);k.ranges[j.xScaleID]={min:Math.min(l,h),max:Math.max(l,h)}}if(n){l=f.isValid(j.yMin)?j.yMin:n.getPixelForValue(m.bottom);h=f.isValid(j.yMax)?j.yMax:n.getPixelForValue(m.top);k.ranges[j.yScaleID]={min:Math.min(l,h),max:Math.max(l,h)}}},configure:function(){var m=this._model;var r=this.options;var s=this.chartInstance;var q=s.scales[r.xScaleID];var j=s.scales[r.yScaleID];var i=s.chartArea;m.clip={x1:i.left,x2:i.right,y1:i.top,y2:i.bottom};var k=i.left,o=i.top,p=i.right,h=i.bottom;var l,n;if(q){l=f.isValid(r.xMin)?q.getPixelForValue(r.xMin):i.left;n=f.isValid(r.xMax)?q.getPixelForValue(r.xMax):i.right;k=Math.min(l,n);p=Math.max(l,n)}if(j){l=f.isValid(r.yMin)?j.getPixelForValue(r.yMin):i.bottom;n=f.isValid(r.yMax)?j.getPixelForValue(r.yMax):i.top;o=Math.min(l,n);h=Math.max(l,n)}m.left=k;m.top=o;m.right=p;m.bottom=h;m.borderColor=r.borderColor;m.borderWidth=r.borderWidth;m.backgroundColor=r.backgroundColor},inRange:function(j,i){var h=this._model;return h&&j>=h.left&&j<=h.right&&i>=h.top&&i<=h.bottom},getCenterPoint:function(){var h=this._model;return{x:(h.right+h.left)/2,y:(h.bottom+h.top)/2}},getWidth:function(){var h=this._model;return Math.abs(h.right-h.left)},getHeight:function(){var h=this._model;return Math.abs(h.bottom-h.top)},getArea:function(){return this.getWidth()*this.getHeight()},draw:function(){var j=this._view;var i=this.chartInstance.chart.ctx;i.save();i.beginPath();i.rect(j.clip.x1,j.clip.y1,j.clip.x2-j.clip.x1,j.clip.y2-j.clip.y1);i.clip();i.lineWidth=j.borderWidth;i.strokeStyle=j.borderColor;i.fillStyle=j.backgroundColor;var k=j.right-j.left,h=j.bottom-j.top;i.fillRect(j.left,j.top,k,h);i.strokeRect(j.left,j.top,k,h);i.restore()}});return g}},{"../helpers.js":5}],8:[function(b,c,a){c.exports=function(f){var d=f.helpers;var k=b("../helpers.js")(f);var h="horizontal";var j="vertical";var i=f.Annotation.Element.extend({setDataLimits:function(){var n=this._model;var m=this.options;n.ranges={};n.ranges[m.scaleID]={min:m.value,max:m.endValue||m.value}},configure:function(){var r=this._model;var v=this.options;var w=this.chartInstance;var u=w.chart.ctx;var p=w.scales[v.scaleID];var o,m;if(p){o=k.isValid(v.value)?p.getPixelForValue(v.value):NaN;m=k.isValid(v.endValue)?p.getPixelForValue(v.endValue):o}if(isNaN(o)){return}var n=w.chartArea;r.clip={x1:n.left,x2:n.right,y1:n.top,y2:n.bottom};if(this.options.mode==h){r.x1=n.left;r.x2=n.right;r.y1=o;r.y2=m}else{r.y1=n.top;r.y2=n.bottom;r.x1=o;r.x2=m}r.line=new g(r);r.mode=v.mode;r.labelBackgroundColor=v.label.backgroundColor;r.labelFontFamily=v.label.fontFamily;r.labelFontSize=v.label.fontSize;r.labelFontStyle=v.label.fontStyle;r.labelFontColor=v.label.fontColor;r.labelXPadding=v.label.xPadding;r.labelYPadding=v.label.yPadding;r.labelCornerRadius=v.label.cornerRadius;r.labelPosition=v.label.position;r.labelXAdjust=v.label.xAdjust;r.labelYAdjust=v.label.yAdjust;r.labelEnabled=v.label.enabled;r.labelContent=v.label.content;u.font=d.fontString(r.labelFontSize,r.labelFontStyle,r.labelFontFamily);var s=u.measureText(r.labelContent).width;var t=u.measureText("M").width;var q=l(r,s,t,r.labelXPadding,r.labelYPadding);r.labelX=q.x-r.labelXPadding;r.labelY=q.y-r.labelYPadding;r.labelWidth=s+(2*r.labelXPadding);r.labelHeight=t+(2*r.labelYPadding);r.borderColor=v.borderColor;r.borderWidth=v.borderWidth;r.borderDash=v.borderDash||[];r.borderDashOffset=v.borderDashOffset||0},inRange:function(o,n){var m=this._model;return(m.line&&m.line.intersects(o,n,this.getHeight()))||(m.labelEnabled&&m.labelContent&&o>=m.labelX&&o<=m.labelX+m.labelWidth&&n>=m.labelY&&n<=m.labelY+m.labelHeight)},getCenterPoint:function(){return{x:(this._model.x2+this._model.x1)/2,y:(this._model.y2+this._model.y1)/2}},getWidth:function(){return Math.abs(this._model.right-this._model.left)},getHeight:function(){return this._model.borderWidth||1},getArea:function(){return Math.sqrt(Math.pow(this.getWidth(),2)+Math.pow(this.getHeight(),2))},draw:function(){var n=this._view;var m=this.chartInstance.chart.ctx;if(!n.clip){return}m.save();m.beginPath();m.rect(n.clip.x1,n.clip.y1,n.clip.x2-n.clip.x1,n.clip.y2-n.clip.y1);m.clip();m.lineWidth=n.borderWidth;m.strokeStyle=n.borderColor;if(m.setLineDash){m.setLineDash(n.borderDash)}m.lineDashOffset=n.borderDashOffset;m.beginPath();m.moveTo(n.x1,n.y1);m.lineTo(n.x2,n.y2);m.stroke();if(n.labelEnabled&&n.labelContent){m.beginPath();m.rect(n.clip.x1,n.clip.y1,n.clip.x2-n.clip.x1,n.clip.y2-n.clip.y1);m.clip();m.fillStyle=n.labelBackgroundColor;d.drawRoundedRectangle(m,n.labelX,n.labelY,n.labelWidth,n.labelHeight,n.labelCornerRadius);m.fill();m.font=d.fontString(n.labelFontSize,n.labelFontStyle,n.labelFontFamily);m.fillStyle=n.labelFontColor;m.textAlign="center";m.textBaseline="middle";m.fillText(n.labelContent,n.labelX+(n.labelWidth/2),n.labelY+(n.labelHeight/2))}m.restore()}});function g(p){var o=(p.x2-p.x1)/(p.y2-p.y1);var n=p.x1||0;this.m=o;this.b=n;this.getX=function(m){return o*(m-p.y1)+n};this.getY=function(m){return((m-n)/o)+p.y1};this.intersects=function(m,t,s){s=s||0.001;var q=this.getY(m),r=this.getX(t);return((!isFinite(q)||Math.abs(t-q)<s)&&(!isFinite(r)||Math.abs(m-r)<s))}}function l(s,n,t,o,p){var u=s.line;var q={},m=0,r=0;switch(true){case s.mode==j&&s.labelPosition=="top":r=p+s.labelYAdjust;m=(n/2)+s.labelXAdjust;q.y=s.y1+r;q.x=(isFinite(u.m)?u.getX(q.y):s.x1)-m;break;case s.mode==j&&s.labelPosition=="bottom":r=t+p+s.labelYAdjust;m=(n/2)+s.labelXAdjust;q.y=s.y2-r;q.x=(isFinite(u.m)?u.getX(q.y):s.x1)-m;break;case s.mode==h&&s.labelPosition=="left":m=o+s.labelXAdjust;r=-(t/2)+s.labelYAdjust;q.x=s.x1+m;q.y=u.getY(q.x)+r;break;case s.mode==h&&s.labelPosition=="right":m=n+o+s.labelXAdjust;r=-(t/2)+s.labelYAdjust;q.x=s.x2-m;q.y=u.getY(q.x)+r;break;default:q.x=((s.x1+s.x2-n)/2)+s.labelXAdjust;q.y=((s.y1+s.y2-t)/2)+s.labelYAdjust}return q}return i}},{"../helpers.js":5}]},{},[6]);