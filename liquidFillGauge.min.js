/*!
 * @license Open source under BSD 2-clause (http://choosealicense.com/licenses/bsd-2-clause/)
 * Copyright (c) 2015, Curtis Bratton
 * All rights reserved.
 *
 * Liquid Fill Gauge v1.1
 */
;function liquidFillGaugeDefaultSettings(){return{minValue:0,maxValue:100,circleThickness:0.05,circleFillGap:0.05,circleColor:"#178BCA",waveHeight:0.05,waveCount:1,waveRiseTime:1000,waveAnimateTime:18000,waveRise:true,waveHeightScaling:true,waveAnimate:true,waveColor:"#178BCA",waveOffset:0,textVertPosition:0.5,textSize:1,valueCountUp:true,displayPercent:true,textColor:"#045681",waveTextColor:"#A4DBf8"}}function loadLiquidFillGauge(f,F,D){if(D==null){D=liquidFillGaugeDefaultSettings()}var r=d3.select("#"+f);var H=Math.min(parseInt(r.style("width")),parseInt(r.style("height")))/2;var B=parseInt(r.style("width"))/2-H;var z=parseInt(r.style("height"))/2-H;var G=Math.max(D.minValue,Math.min(D.maxValue,F))/D.maxValue;var n;if(D.waveHeightScaling){n=d3.scale.linear().range([0,D.waveHeight,0]).domain([0,50,100])}else{n=d3.scale.linear().range([D.waveHeight,D.waveHeight]).domain([0,100])}var u=(D.textSize*H/2);var d=parseFloat(F).toFixed(2);var y=D.valueCountUp?D.minValue:d;var N=D.displayPercent?"%":"";var h=D.circleThickness*H;var j=D.circleFillGap*H;var M=h+j;var v=H-M;var a=v*n(G*100);var p=v*2/D.waveCount;var J=1+D.waveCount;var R=p*J;var E=function(i){return Math.round(i)};if(parseFloat(d)!=parseFloat(E(d))){E=function(i){return parseFloat(i).toFixed(1)}}if(parseFloat(d)!=parseFloat(E(d))){E=function(i){return parseFloat(i).toFixed(2)}}var Q=[];for(var O=0;O<=40*J;O++){Q.push({x:O/(40*J),y:(O/(40))})}var m=d3.scale.linear().range([0,2*Math.PI]).domain([0,1]);var k=d3.scale.linear().range([0,H]).domain([0,H]);var C=d3.scale.linear().range([0,R]).domain([0,1]);var A=d3.scale.linear().range([0,a]).domain([0,1]);var e=d3.scale.linear().range([(M+v*2+a),(M-a)]).domain([0,1]);var g=d3.scale.linear().range([0,R-v*2]).domain([0,1]);var P=d3.scale.linear().range([M+v*2,(M+u*0.7)]).domain([0,1]);var q=r.append("g").attr("transform","translate("+B+","+z+")");var o=d3.svg.arc().startAngle(m(0)).endAngle(m(1)).outerRadius(k(H)).innerRadius(k(H-h));q.append("path").attr("d",o).style("fill",D.circleColor).attr("transform","translate("+H+","+H+")");var t=q.append("text").text(E(y)+N).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",u+"px").style("fill",D.textColor).attr("transform","translate("+H+","+P(D.textVertPosition)+")");var c=d3.svg.area().x(function(i){return C(i.x)}).y0(function(i){return A(Math.sin(Math.PI*2*D.waveOffset*-1+Math.PI*2*(1-D.waveCount)+i.y*2*Math.PI))}).y1(function(i){return(v*2+a)});var L=q.append("defs").append("clipPath").attr("id","clipWave"+f);var b=L.append("path").datum(Q).attr("d",c).attr("T",0);var I=q.append("g").attr("clip-path","url(#clipWave"+f+")");I.append("circle").attr("cx",H).attr("cy",H).attr("r",v).style("fill",D.waveColor);var s=I.append("text").text(E(y)+N).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",u+"px").style("fill",D.waveTextColor).attr("transform","translate("+H+","+P(D.textVertPosition)+")");if(D.valueCountUp){var w=function(){var S=d3.interpolate(this.textContent,d);return function(i){this.textContent=E(S(i))+N}};t.transition().duration(D.waveRiseTime).tween("text",w);s.transition().duration(D.waveRiseTime).tween("text",w)}var l=M+v*2-R;if(D.waveRise){L.attr("transform","translate("+l+","+e(0)+")").transition().duration(D.waveRiseTime).attr("transform","translate("+l+","+e(G)+")").each("start",function(){b.attr("transform","translate(1,0)")})}else{L.attr("transform","translate("+l+","+e(G)+")")}if(D.waveAnimate){K()}function K(){b.attr("transform","translate("+g(b.attr("T"))+",0)");b.transition().duration(D.waveAnimateTime*(1-b.attr("T"))).ease("linear").attr("transform","translate("+g(1)+",0)").attr("T",1).each("end",function(){b.attr("T",0);K(D.waveAnimateTime)})}function x(){this.update=function(ac){var aa=parseFloat(ac).toFixed(2);var Z=function(ad){return Math.round(ad)};if(parseFloat(aa)!=parseFloat(Z(aa))){Z=function(ad){return parseFloat(ad).toFixed(1)}}if(parseFloat(aa)!=parseFloat(Z(aa))){Z=function(ad){return parseFloat(ad).toFixed(2)}}var V=function(){var ad=d3.interpolate(this.textContent,parseFloat(ac).toFixed(2));return function(ae){this.textContent=Z(ad(ae))+N}};t.transition().duration(D.waveRiseTime).tween("text",V);s.transition().duration(D.waveRiseTime).tween("text",V);var S=Math.max(D.minValue,Math.min(D.maxValue,ac))/D.maxValue;var U=v*n(S*100);var T=d3.scale.linear().range([(M+v*2+U),(M-U)]).domain([0,1]);var i=T(S);var X=d3.scale.linear().range([0,R]).domain([0,1]);var W=d3.scale.linear().range([0,U]).domain([0,1]);var ab;if(D.waveHeightScaling){ab=d3.svg.area().x(function(ad){return X(ad.x)}).y0(function(ad){return W(Math.sin(Math.PI*2*D.waveOffset*-1+Math.PI*2*(1-D.waveCount)+ad.y*2*Math.PI))}).y1(function(ad){return(v*2+U)})}else{ab=c}var Y=D.waveAnimate?g(1):0;b.transition().duration(0).transition().duration(D.waveAnimate?(D.waveAnimateTime*(1-b.attr("T"))):(D.waveRiseTime)).ease("linear").attr("d",ab).attr("transform","translate("+Y+",0)").attr("T","1").each("end",function(){if(D.waveAnimate){b.attr("transform","translate("+g(0)+",0)");K(D.waveAnimateTime)}});L.transition().duration(D.waveRiseTime).attr("transform","translate("+l+","+i+")")}}return new x()};